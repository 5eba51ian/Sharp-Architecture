<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

  <Choose>
      <When Condition="('$(OutputPath)'!='')">
      </When>
      <!-- Running outside of the build -->
      <Otherwise>
        <PropertyGroup>
          <OutputPath>bin\debug</OutputPath>
        </PropertyGroup>
      </Otherwise>
    </Choose>
  
  <Target Name="RunSpecs"
          DependsOnTargets="BuildSolutions;CreateDrops">

    <MakeDir Directories="$(DropsPath)\$(GlobalBuildVersionNumber)\MSpec"/>
    
    <PropertyGroup>
      <MSpecOptions>--html $(DropsPath)\$(GlobalBuildVersionNumber)\MSpec\Specs.html</MSpecOptions>
      <MSpecArgs>$(SolutionsPath)\SharpArch\SharpArch.Specifications\bin\Release\SharpArch.Specifications.dll</MSpecArgs>
      <MSpecCommand>$(ReferencedAssembliesPath)\Machine.Specifications\mspec $(MSpecOptions) $(MSpecArgs)</MSpecCommand>
    </PropertyGroup>
    
    <Message Importance="high" Text="Running Specs with this command: $(MSpecCommand)"/>
    
    <Exec Command="$(MSpecCommand)" />
  
  </Target>

</Project>